(this.webpackJsonpExpenditures=this.webpackJsonpExpenditures||[]).push([[8],{60:function(e,t,n){e.exports=n(84)},66:function(e,t,n){var a={"./ion-action-sheet-controller_8.entry.js":[90,43],"./ion-action-sheet-ios.entry.js":[91,44],"./ion-action-sheet-md.entry.js":[92,45],"./ion-alert-ios.entry.js":[93,24],"./ion-alert-md.entry.js":[94,25],"./ion-app_8-ios.entry.js":[95,11],"./ion-app_8-md.entry.js":[96,12],"./ion-avatar_3-ios.entry.js":[97,46],"./ion-avatar_3-md.entry.js":[98,47],"./ion-back-button-ios.entry.js":[99,48],"./ion-back-button-md.entry.js":[100,49],"./ion-backdrop-ios.entry.js":[101,81],"./ion-backdrop-md.entry.js":[102,82],"./ion-button_2-ios.entry.js":[103,50],"./ion-button_2-md.entry.js":[104,51],"./ion-card_5-ios.entry.js":[105,52],"./ion-card_5-md.entry.js":[106,53],"./ion-checkbox-ios.entry.js":[107,54],"./ion-checkbox-md.entry.js":[108,55],"./ion-chip-ios.entry.js":[109,56],"./ion-chip-md.entry.js":[110,57],"./ion-col_3.entry.js":[111,83],"./ion-datetime_3-ios.entry.js":[112,20],"./ion-datetime_3-md.entry.js":[113,21],"./ion-fab_3-ios.entry.js":[114,58],"./ion-fab_3-md.entry.js":[115,59],"./ion-img.entry.js":[116,84],"./ion-infinite-scroll_2-ios.entry.js":[117,39],"./ion-infinite-scroll_2-md.entry.js":[118,40],"./ion-input-ios.entry.js":[119,60],"./ion-input-md.entry.js":[120,61],"./ion-item-option_3-ios.entry.js":[121,62],"./ion-item-option_3-md.entry.js":[122,63],"./ion-item_8-ios.entry.js":[123,64],"./ion-item_8-md.entry.js":[124,65],"./ion-loading-ios.entry.js":[125,26],"./ion-loading-md.entry.js":[126,27],"./ion-menu_4-ios.entry.js":[127,18],"./ion-menu_4-md.entry.js":[128,19],"./ion-modal-ios.entry.js":[129,14],"./ion-modal-md.entry.js":[130,15],"./ion-nav_5.entry.js":[131,13],"./ion-popover-ios.entry.js":[132,16],"./ion-popover-md.entry.js":[133,17],"./ion-progress-bar-ios.entry.js":[134,66],"./ion-progress-bar-md.entry.js":[135,67],"./ion-radio_2-ios.entry.js":[136,32],"./ion-radio_2-md.entry.js":[137,33],"./ion-range-ios.entry.js":[138,68],"./ion-range-md.entry.js":[139,69],"./ion-refresher_2-ios.entry.js":[140,41],"./ion-refresher_2-md.entry.js":[141,42],"./ion-reorder_2-ios.entry.js":[142,37],"./ion-reorder_2-md.entry.js":[143,38],"./ion-ripple-effect.entry.js":[144,85],"./ion-route_4.entry.js":[145,70],"./ion-searchbar-ios.entry.js":[146,28],"./ion-searchbar-md.entry.js":[147,29],"./ion-segment_2-ios.entry.js":[148,71],"./ion-segment_2-md.entry.js":[149,72],"./ion-select_3-ios.entry.js":[150,34],"./ion-select_3-md.entry.js":[151,35],"./ion-slide_2-ios.entry.js":[152,86],"./ion-slide_2-md.entry.js":[153,87],"./ion-spinner.entry.js":[154,73],"./ion-split-pane-ios.entry.js":[155,88],"./ion-split-pane-md.entry.js":[156,89],"./ion-tab-bar_2-ios.entry.js":[157,74],"./ion-tab-bar_2-md.entry.js":[158,75],"./ion-tab_2.entry.js":[159,36],"./ion-text.entry.js":[160,76],"./ion-textarea-ios.entry.js":[161,77],"./ion-textarea-md.entry.js":[162,78],"./ion-toast-ios.entry.js":[163,30],"./ion-toast-md.entry.js":[164,31],"./ion-toggle-ios.entry.js":[165,22],"./ion-toggle-md.entry.js":[166,23],"./ion-virtual-scroll.entry.js":[167,90]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=66,e.exports=r},67:function(e,t,n){var a={"./ion-icon.entry.js":[171,98]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=67,e.exports=r},83:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(24),o=n.n(s),i=n(3),l=n(4),c=n(8),u=n(7),m=n(9),d=n(12),h=n(1),y=n(51),p=n(22),f=n(5),j=n(173),g=n(174);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=function e(){Object(i.a)(this,e),this.username="n/a",this.amount=0,this.reason="n/a",this.id=-1,this.tags=[]},O=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={expenditures:Array(),showModal:!1,newItem:new v,userName:n.getUsername(),userNameIsSet:""!==n.getUsername(),availableUserNames:Array(),tags:Array(),balance:0,isSaving:!1},n.handleSubmit=n.handleSubmit.bind(Object(f.a)(n)),n.handleChangeAmount=n.handleChangeAmount.bind(Object(f.a)(n)),n.handleChangeReason=n.handleChangeReason.bind(Object(f.a)(n)),n.handleChangeUser=n.handleChangeUser.bind(Object(f.a)(n)),n.handleSubmitUsername=n.handleSubmitUsername.bind(Object(f.a)(n)),n.handleChangeUsername=n.handleChangeUsername.bind(Object(f.a)(n)),n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setState({newItem:E({},this.state.newItem,{username:this.state.userName})}),this.doRefresh()}},{key:"deleteExpenditure",value:function(e){var t=this;fetch("/api/expenditures/".concat(e.id),{method:"DELETE"}).then((function(n){var a=t.state.expenditures.filter((function(t){return t.id!==e.id}));t.setState({expenditures:a}),t.doRefresh()})).catch(console.log)}},{key:"addExpenditure",value:function(e){var t=this,n={amount:(100*e.amount).toFixed(0),reason:e.reason,username:e.username,tags:e.tags};return this.setState({isSaving:!0}),fetch("/api/expenditures",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(n)}).then((function(){t.doRefresh()})).catch((function(e){console.log(e),alert("Speichern fehlgeschlagen")})).finally((function(){t.setState({showModal:!1,isSaving:!1})}))}},{key:"saveUsername",value:function(e){var t=new Date;t.setTime(t.getTime()+615168e5),document.cookie="username=".concat(e,"; expires=").concat(t.toUTCString())}},{key:"getUsername",value:function(){var e=document.cookie.replace(/(?:(?:^|.*;\s*)username\s*=\s*([^;]*).*$)|^.*$/,"$1");return this.saveUsername(e),e}},{key:"doRefresh",value:function(e){var t=this;fetch("/api/expenditures?limit=20").then((function(e){return e.json()})).then((function(n){t.setState({expenditures:n.map((function(e){return e.amount=e.amount/100,e}))}),e&&e.detail.complete()})).catch(console.log),fetch("/api/tags").then((function(e){return e.json()})).then((function(e){t.setState({tags:e})})).catch(console.log),fetch("/api/current-status").then((function(e){return e.json()})).then((function(e){return console.log(e),t.setState({availableUserNames:e.map((function(e){return e[0]}))}),e})).then((function(e){var n=e.find((function(e){return e[0]===t.state.userName})),a=e.find((function(e){return e[0]!==t.state.userName})),r=n[1]-a[1];return t.setState({balance:r/100}),e})).catch(console.log)}},{key:"handleChangeAmount",value:function(e){this.setState({newItem:E({},this.state.newItem,{amount:(e.detail.value||"0").replace(",",".")})})}},{key:"handleChangeReason",value:function(e){this.setState({newItem:E({},this.state.newItem,{reason:e.detail.value})})}},{key:"handleChangeUser",value:function(e){console.log(this.state),this.setState({newItem:E({},this.state.newItem,{username:e.detail.value})})}},{key:"handleToggleTag",value:function(e){var t=this.state.newItem.tags.map((function(e){return e.name})).indexOf(e.name),n=this.state.newItem.tags;t>=0?n.splice(t,1):n.push(e),this.setState({newItem:E({},this.state.newItem,{tags:n})}),console.log(this.state.newItem.tags)}},{key:"handleChangeUsername",value:function(e){this.setState({userName:e.detail.value})}},{key:"newItemHasTag",value:function(e){return this.state.newItem.tags.map((function(e){return e.name})).indexOf(e.name)>=0}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state.newItem;this.addExpenditure(t)}},{key:"handleSubmitUsername",value:function(e){e.preventDefault(),this.saveUsername(this.state.userName),this.setState({userNameIsSet:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement(h.t,null,r.a.createElement(h.i,null,r.a.createElement(h.A,null,r.a.createElement(h.z,null,"Letzte Ausgaben"),r.a.createElement(h.l,{slot:"end"},r.a.createElement(h.p,{position:"fixed",color:this.state.balance<0?"warning":"success"},r.a.createElement("p",null,"Status:"),r.a.createElement("p",null,this.state.balance.toLocaleString(void 0,{style:"currency",currency:"EUR"})))))),r.a.createElement(h.f,{fullscreen:!0,className:"ion-padding"},r.a.createElement(h.u,{slot:"fixed",onIonRefresh:function(t){return e.doRefresh(t)}},r.a.createElement(h.v,null)),r.a.createElement(h.r,null,this.state.expenditures.map((function(t){return r.a.createElement(h.o,{key:t.id.toString()},r.a.createElement(h.l,null,r.a.createElement(h.p,{position:"fixed"},t.reason,r.a.createElement("p",null,t.username)),t.tags.map((function(e){return r.a.createElement(h.e,{color:"primary"},r.a.createElement(h.p,null,e.name))})),r.a.createElement(h.p,{slot:"end",color:"success",position:"fixed"},t.amount.toLocaleString(void 0,{style:"currency",currency:"EUR"}))),r.a.createElement(h.n,{side:"end"},r.a.createElement(h.m,{color:"danger",onClick:function(){e.deleteExpenditure(t)}},"L\xf6schen")))}))),r.a.createElement(h.g,{vertical:"bottom",horizontal:"end",slot:"fixed"},r.a.createElement(h.h,{onClick:function(){return e.setState({showModal:!0})}},r.a.createElement(h.j,{icon:j.a})))),r.a.createElement(h.s,{isOpen:this.state.showModal},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(h.i,{translucent:!0},r.a.createElement(h.A,null,r.a.createElement(h.z,null,"Ausgabe eintragen"),r.a.createElement(h.d,{slot:"start"},r.a.createElement(h.c,{onClick:function(){return e.setState({showModal:!1})}},"Abbrechen")),r.a.createElement(h.d,{slot:"end"},r.a.createElement(h.c,{color:"primary",type:"submit",disabled:this.state.isSaving},"Speichern")))),r.a.createElement(h.f,{fullscreen:!0},r.a.createElement(h.l,null,r.a.createElement(h.p,null,"Betrag"),r.a.createElement(h.k,{inputMode:"decimal",pattern:"^[0-9]+([\\.,][0-9]{1,2})?$",required:!0,onIonChange:this.handleChangeAmount,placeholder:"0.00"})," \u20ac"),r.a.createElement(h.l,null,r.a.createElement(h.p,null,"Grund"),r.a.createElement(h.k,{required:!0,onIonChange:this.handleChangeReason,placeholder:"Shop oder Zweck"})),r.a.createElement(h.l,null,r.a.createElement(h.p,null,"Gezahlt von"),r.a.createElement(h.x,{onIonChange:this.handleChangeUser},this.state.availableUserNames.map((function(t){return r.a.createElement(h.y,{selected:t===e.state.newItem.username,key:t,value:t},t)})))),r.a.createElement(h.l,null,r.a.createElement(h.p,null,"Tags:"),this.state.tags.map((function(t){return r.a.createElement(h.e,{onClick:function(n){return e.handleToggleTag(t)},color:"primary",outline:!1===e.newItemHasTag(t)},r.a.createElement(h.j,{icon:e.newItemHasTag(t)?g.a:j.a}),r.a.createElement(h.p,null,t.name))})))))),r.a.createElement(h.s,{isOpen:!this.state.userNameIsSet},r.a.createElement("form",{onSubmit:this.handleSubmitUsername},r.a.createElement(h.i,{translucent:!0},r.a.createElement(h.A,null,r.a.createElement(h.z,null,"Nutzer eintragen"),r.a.createElement(h.d,{slot:"end"},r.a.createElement(h.c,{color:"primary",type:"submit"},"Speichern")))),r.a.createElement(h.f,{fullscreen:!0},r.a.createElement(h.l,null,r.a.createElement(h.p,null,"Nutzer"),r.a.createElement(h.k,{required:!0,onIonChange:this.handleChangeUsername}))))))}}]),t}(r.a.Component),S=(n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(82),n(83),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(h.b,null,r.a.createElement(y.a,null,r.a.createElement(h.w,null,r.a.createElement(d.b,{path:"/home",component:O,exact:!0}),r.a.createElement(d.b,{exact:!0,path:"/",render:function(){return r.a.createElement(d.a,{to:"/home"})}}))))}}]),t}(r.a.Component));o.a.render(r.a.createElement(S,null),document.getElementById("root"))}},[[60,9,10]]]);
//# sourceMappingURL=main.3de5205b.chunk.js.map